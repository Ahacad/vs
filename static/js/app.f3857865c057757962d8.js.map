{"version":3,"sources":["webpack:///./node_modules/flatqueue/index.mjs","webpack:///./src/lib/jsonpFetch.js","webpack:///./src/bus.js","webpack:///./src/lib/buildGraph.js","webpack:///./src/Progress.js","webpack:///./src/appState.js","webpack:///./src/lib/measureText.js","webpack:///./src/lib/layout/Vector.js","webpack:///./src/lib/layout/flock.js","webpack:///./src/lib/layout/boidLayout.js","webpack:///./src/lib/layout/getDelaunayGraph.js","webpack:///./src/lib/layout/makeSpanningTree.js","webpack:///./src/lib/layout/removeOverlaps.js","webpack:///./src/lib/layout/Rect.js","webpack:///./src/lib/aggregateLayout.js","webpack:///./src/lib/createInterpolateLayout.js","webpack:///./src/lib/renderer/linkAnimator.js","webpack:///./src/lib/buildLinkIndex.js","webpack:///./src/lib/createRenderer.js","webpack:///src/components/About.vue","webpack:///./src/components/About.vue?d944","webpack:///./src/components/About.vue","webpack:///src/components/QueryInput.vue","webpack:///./src/components/QueryInput.vue?8cd7","webpack:///./src/components/QueryInput.vue","webpack:///src/App.vue","webpack:///./src/App.vue?b446","webpack:///./src/App.vue","webpack:///./src/main.js"],"names":["__webpack_exports__","[object Object]","this","ids","values","length","id","value","pos","parent","parentValue","top","halfLength","left","right","bestIndex","bestValue","rightValue","myIndex","bus","require","buildGraph","entryWord","pattern","MAX_DEPTH","progress","trim","toLocaleLowerCase","insertPosition","indexOf","Error","queryPosition","cancelled","pendingResponse","graph","maxDepth","queue","requestDelay","Math","random","startDownload","addNode","depth","fetchNext","dispose","cancel","loadNext","nextWord","shift","updateLayout","fire","query","url","isCancelled","actualResolve","loadScript","name","window","e","cancelable","promise_default","a","resolve","reject","document","createElement","src","onerror","head","appendChild","removeChild","jsonpFetch","encodeURIComponent","getResponse","fullQuery","then","res","console","error","results","q","parentNode","getNode","filter","x","map","substring","forEach","other","hasOtherNode","hasNode","hasOtherLink","getLink","addLink","data","push","setTimeout","loadSiblings","onPendingReady","catch","msg","err","downloadError","replace","Progress","classCallCheck_default","message","phase","download","errors","remaining","currentWord","layout","iteration","working","layoutCompletion","qs","queryState","useSearch","lastBuilder","appStateFromQuery","get","appState","hasGraph","performSearch","queryString","reset","set","freeze_default","resolveQueryFromLink","from","to","onChange","newState","svgns","xmlns","createTextMeasure","svgContainer","options","useFastTextMeasure","cachedSizes","cachedWords","create_default","abc","avgLetterWidthByFontSize","safariGuess","1","0.875","0.833","0.75","0.5","text","fontSize","round","cacheKey","cachedResult","result","textContainer","createElementNS","setAttributeNS","words","split","width","avgWidthAtFontSize","textContent","abcWidth","measureTextWidth","measureAvgWidth","cachedWordsKey","size","undefined","preciseMeasure","measureText","spaceWidth","spaceWidthKey","totalWidth","word","sumUpWordsLengthInPixels","svgTextElement","getBBox","Vector","y","createClass_default","key","l","sqrt","scalar","maxMag","mag","dx","dy","b","Flock","boids","map_default","neighbors","_this","boid","nodeId","forEachLinkedNode","otherBoid","run","boidId","setDesiredPosition","Boid","acceleration","angle","nextDouble","PI","velocity","cos","sin","position","desiredPosition","r","maxspeed","maxforce","flock","update","force","nCount","div","add","sep","separate","ali","align","coh","cohesion","mass","applyForce","pull","sub","limit","mult","target","desired","normalize","steer","_this2","count","d","distanceTo","diff","_this3","sum","dist","_this4","seek","createRandom","addTriangulationLink","fromId","toId","tGraph","createGraph","EdgeModel","removeOverlaps","rectangles","vertices","canMove","yes","pullX","pullY","pair","cx","cy","triangulationGraph","triangles","Delaunator","v","i","first","second","third","getDelaunayGraph","forEachLink","link","getRect","weight","overlaps","centerDistance","getPointDistance","t","getOverlapFactor","bottom","getRectangularDistance","getTriangulationWeight","mstEdges","findMinimumSpanningTree","edge","spanningTree","spanningGraph","getGraph","processed","set_default","growAt","has","rootPos","otherNode","childPos","removeOverlapsForRectangles","getRootId","grow","rootId","gentNode","makeSpanningTree","arrayOfRects","from_default","is_finite_default","abs","wx","wy","height","min","Rect","params","assign_default","isNumber","factor","eventify","createLayout","USE_FAKE","USE_INTERPOLATE","REMOVE_OVERLAPS","USE_REAL","createAggregateLayout","physicsLayout","springLength","springCoeff","gravity","theta","dragCoeff","timeStep","nodeMass","links","getLinks","mul","node","fakeLayout","nodes","getNodePosition","setDesiredNodePosition","setDesiredBoidPosition","step","addBoid","createFakeLayout","interpolateLayout","duration","arguments","elapsed","ease","fromPos","toPos","done","createInterpolateLayout","isGraphReady","layoutIterations","layoutTime","maxLayoutIterations","maxLayoutTime","api","start","performance","now","finished","max","forEachNode","setLayoutCompletion","getRectangles","rect","setNodePosition","pinNode","setGraphReady","getGraphReady","rects","inflatedRect","svg","distance","createRenderer","scene","querySelector","nodeContainer","edgeContainer","hideTooltipArgs","isVisible","svgEl","pt","createSVGPoint","createPanZoom","showRectangle","linkIndex","currentLayoutFrame","linkAnimator","textMeasure","on","onGraphReady","render","newGraph","clearLastScene","drawLinks","onGraphStructureChanged","cancelAnimationFrame","requestAnimationFrame","frame","off","onMouseMove","minLink","clientX","clientY","_minLink$link","findLinkInfoFromEvent","removeHighlight","classList","ui","onSceneClick","info","linkInfo","getLinkInfo","linkId","svgP","matrixTransform","getScreenCTM","inverse","findNearestLink","getNearestLink","querySelectorAll","removeHoverClass","el","remove","readyGraph","startLayout","attr","changes","change","changeType","beingAnimated","scheduled","maxAnimations","sort","getLinkScore","processor","processNext","pop","speed","gaussian","animateLink","isDone","delete","fromNode","toNode","maxT","dRatio","strokeWidth","color","pathData","class","stroke-width","fill","stroke","createLinkAnimator","addEventListener","maxDistance","_createInternalIndex","points","linkDistance","nextPoint","pointIndex","Flatbush","pointSize","point","finish","createInternalIndex","pointId","getPoints","buildLinkIndex","clear","removeEventListener","lastChild","uiAttributes","rx","ry","px","py","getNodeUIAttributes","rectAttributes","textAttributes","font-size","transform","About","mounted","closeHandler","keyCode","preventDefault","close","beforeDestroy","methods","$emit","components_About","_vm","_h","$createElement","_c","_self","staticClass","click","$event","_v","attrs","href","_m","alt","staticRenderFns","QueryInput","props","watch","newValue","ensureSuffixPos","computed","patternReminder","patternPrefix","focus","$refs","input","_$refs","suffix","measure","prefix","innerText","textWidth","getBoundingClientRect","suffixBox","prefixBox","maxValue","$el","suffixPos","style","visibility","paddingRight","paddingLeft","components_QueryInput","ref","type","placeholder","autofocus","domProps","_s","App","aboutVisible","src_appState","tooltip","components","__webpack_require__","normalizeComponent","ssrContext","QueryInput_normalizeComponent","isLoading","forwardFocus","queryInput","onSubmit","renderer","blur","showTooltip","event","showDetails","open","src_bus","selectortype_template_index_0_src_App","submit","model","callback","$$v","$set","expression","_e","src_App","App_normalizeComponent","Vue","config","productionTip","template"],"mappings":"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","file":"static/js/app.f3857865c057757962d8.js","sourcesContent":["\nexport default class FlatQueue {\n\n    constructor() {\n        this.ids = [];\n        this.values = [];\n        this.length = 0;\n    }\n\n    clear() {\n        this.length = 0;\n    }\n\n    push(id, value) {\n        let pos = this.length++;\n        this.ids[pos] = id;\n        this.values[pos] = value;\n\n        while (pos > 0) {\n            const parent = (pos - 1) >> 1;\n            const parentValue = this.values[parent];\n            if (value >= parentValue) break;\n            this.ids[pos] = this.ids[parent];\n            this.values[pos] = parentValue;\n            pos = parent;\n        }\n\n        this.ids[pos] = id;\n        this.values[pos] = value;\n    }\n\n    pop() {\n        if (this.length === 0) return undefined;\n\n        const top = this.ids[0];\n        this.length--;\n\n        if (this.length > 0) {\n            const id = this.ids[0] = this.ids[this.length];\n            const value = this.values[0] = this.values[this.length];\n            const halfLength = this.length >> 1;\n            let pos = 0;\n\n            while (pos < halfLength) {\n                let left = (pos << 1) + 1;\n                const right = left + 1;\n                let bestIndex = this.ids[left];\n                let bestValue = this.values[left];\n                const rightValue = this.values[right];\n\n                if (right < this.length && rightValue < bestValue) {\n                    left = right;\n                    bestIndex = this.ids[right];\n                    bestValue = rightValue;\n                }\n                if (bestValue >= value) break;\n\n                this.ids[pos] = bestIndex;\n                this.values[pos] = bestValue;\n                pos = left;\n            }\n\n            this.ids[pos] = id;\n            this.values[pos] = value;\n        }\n\n        return top;\n    }\n\n    peek() {\n        if (this.length === 0) return undefined;\n        return this.ids[0];\n    }\n\n    peekValue() {\n        if (this.length === 0) return undefined;\n        return this.values[0];\n    }\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/flatqueue/index.mjs\n// module id = HNsV\n// module chunks = 1","let myIndex = 0;\n\n/**\n * Performs JSONP request to a given url\n */\nexport default function jsonpFetch(url) {\n  let isCancelled, actualResolve;\n  let loadScript = null;\n  const name = 'callback' + (myIndex++);\n  window[name] = downloaded;\n  let cancelable = new Promise(download);\n  cancelable.cancel = cancel;\n\n\n  return cancelable;\n\n  function download(resolve, reject) {\n    actualResolve = resolve;\n\n    loadScript = document.createElement('script');\n    loadScript.src = `${url}&callback=${name}`;\n    loadScript.onerror = reject;\n    document.head.appendChild(loadScript);\n  }\n\n  function cancel() {\n    isCancelled = true;\n  }\n\n  function downloaded(e) {\n    if (isCancelled) {\n      dispose();\n      return;\n    }\n\n    actualResolve(e);\n    dispose();\n  }\n\n  function dispose() {\n    if (loadScript) {\n      document.head.removeChild(loadScript);\n      loadScript = null;\n    }\n    delete window[name];\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/jsonpFetch.js","const bus = require('ngraph.events')({});\n\nexport default bus;\n\n\n\n// WEBPACK FOOTER //\n// ./src/bus.js","import jsonpFetch from \"./jsonpFetch\";\nimport bus from '../bus';\n\n/**\n * This function builds a graph from google's auto-suggestions.\n */\nexport default function buildGraph(entryWord, pattern, MAX_DEPTH, progress) {\n  entryWord = entryWord && entryWord.trim();\n  if (!entryWord) return;\n\n  entryWord = entryWord.toLocaleLowerCase();\n\n  const insertPosition = pattern.indexOf('...');\n  if (insertPosition < 0) {\n    throw new Error('Query pattern is missing \"...\"');\n  }\n  const queryPosition = pattern.indexOf('[query]');\n  if (queryPosition < 0) {\n    throw new Error('Query pattern is missing \"[query]\" keyword');\n  }\n\n  if (insertPosition < queryPosition) {\n    throw new Error('[query] should come before ...');\n  }\n\n  let cancelled = false;\n  let pendingResponse;\n  let graph = require('ngraph.graph')();\n  graph.maxDepth = MAX_DEPTH;\n  let queue = [];\n  let requestDelay = 300 + Math.random() * 100;\n  progress.startDownload();\n\n  startQueryConstruction();\n\n  return {\n    dispose,\n    graph\n  }\n\n  function dispose() {\n    cancelled = true;\n    if (pendingResponse) {\n      pendingResponse.cancel();\n      pendingResponse = null;\n    }\n  }\n\n  function startQueryConstruction() {\n    graph.addNode(entryWord, {depth: 0});\n    fetchNext(entryWord);\n  }\n\n  function loadSiblings(parent, results) {\n    let q = fullQuery(parent).toLocaleLowerCase();\n    var parentNode = graph.getNode(parent);\n\n    if (!parentNode) {\n      throw new Error('Parent is missing for ' + parent);\n    }\n\n    results.filter(x => x.toLocaleLowerCase().indexOf(q) === 0)\n      .map(x => x.substring(q.length))\n      .forEach(other => {\n        const hasOtherNode = graph.hasNode(other);\n        const hasOtherLink = graph.getLink(other, parent) || graph.getLink(parent, other);\n        if (hasOtherNode) {\n          if (!hasOtherLink) {\n            graph.addLink(parent, other);\n          }\n          return;\n        }\n\n        let depth = parentNode.data.depth + 1;\n        graph.addNode(other, {depth});\n        graph.addLink(parent, other);\n        if (depth < MAX_DEPTH) queue.push(other);\n      });\n\n    setTimeout(loadNext, requestDelay);\n  }\n\n  function loadNext() {\n    if (cancelled) return;\n    if (queue.length === 0) {\n      bus.fire('graph-ready', graph);\n      return;\n    }\n\n    let nextWord = queue.shift();\n    fetchNext(nextWord);\n    progress.updateLayout(queue.length, nextWord);\n  }\n\n  function fetchNext(query) {\n    pendingResponse = getResponse(fullQuery(query));\n    pendingResponse\n      .then(res => onPendingReady(res, query))\n      .catch((msg) => {\n        const err = 'Failed to download ' + query + '; Message: ' + msg;\n        console.error(err);\n        progress.downloadError(err)\n        loadNext();\n      });\n  }\n\n  function onPendingReady(res, query) {\n    if (res.length >= 2) {\n      loadSiblings(query, res[1]);\n    } else {\n      console.error(res);\n      throw new Error('Unexpected response');\n    }\n  }\n\n  function fullQuery(query) {\n    return pattern.replace('[query]', query).replace('...', '');\n  }\n\n  function getResponse(query) {\n    return jsonpFetch('https://suggestqueries.google.com/complete/search?client=firefox&q=' + encodeURIComponent(query));\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/buildGraph.js","/**\n * Tracks progress of the graph construction and layout\n */\nexport default class Progress {\n  constructor() {\n    this.message = '';\n    this.phase = 'none';\n    this.download = {\n      errors: [],\n      remaining: 0,\n      currentWord: '',\n    };\n    this.layout = {\n      iteration: 0\n    };\n    this.working = true\n  }\n\n  startDownload() {\n    this.phase = 'download';\n  }\n\n  startLayout() {\n    this.message = 'Finished download. Constructing layout...';\n    this.phase = 'layout';\n  }\n\n  setLayoutCompletion(layoutCompletion) {\n    if (this.phase === 'layout') {\n      this.message = `Finished download. Constructing layout ${layoutCompletion}%...`;\n    }\n  }\n\n  updateLayout(remaining, nextWord) {\n    this.download.currentWord = nextWord;\n    this.download.remaining = remaining;\n    this.message = `Remaining: ${remaining}. Downloading ${nextWord}`;\n  }\n\n  done() {\n    this.working = false;\n  }\n\n  downloadError(message) {\n    this.download.errors.push(message);\n  }\n\n  reset() {\n    this.phase = 'none',\n    this.download.errors = [];\n    this.download.remaining = 0;\n    this.download.currentWord = '';\n    this.layout.iteration = 0;\n    this.message = '';\n    this.working = true;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Progress.js","import buildGraph from './lib/buildGraph';\nimport Progress from './Progress';\n\nconst queryState = require('query-state');\n\nconst qs = queryState({\n  query: ''\n}, {\n  useSearch: true\n});\n\nlet lastBuilder;\nconst appStateFromQuery = qs.get();\nconst appState = {\n  hasGraph: false,\n  maxDepth: appStateFromQuery.maxDepth || 2,\n  progress: new Progress(),\n  graph: null,\n  query: appStateFromQuery.query,\n  pattern: appStateFromQuery.pattern || '[query] vs ...'\n}\n\nif (appState.query) {\n  performSearch(appState.query);\n}\n\nexport default appState;\n\nqs.onChange(updateAppState);\n\nfunction updateAppState(newState) {\n  appState.query = newState.query;\n}\n\nexport function performSearch(queryString) {\n  appState.hasGraph = true;\n  appState.progress.reset();\n\n  qs.set('query', queryString);\n  if (lastBuilder) {\n    lastBuilder.dispose();\n  }\n\n  lastBuilder = buildGraph(queryString, appState.pattern, appState.maxDepth, appState.progress);\n  appState.graph = Object.freeze(lastBuilder.graph);\n  return lastBuilder.graph;\n}\n\nexport function resolveQueryFromLink(from, to) {\n  return appState.pattern.replace('[query]', from).replace('...', to);\n}\n\n\n// WEBPACK FOOTER //\n// ./src/appState.js","var svgns = 'http://www.w3.org/2000/svg';\nvar xmlns = 'http://www.w3.org/XML/1998/namespace';\n\n\nexport default function createTextMeasure(svgContainer, options) {\n  options = options || {};\n  if (!('useFastTextMeasure' in options)) {\n    options.useFastTextMeasure = false;\n  }\n\n  var cachedSizes = {};\n  var cachedWords = Object.create(null);\n\n  // TODO: If you need custom language, you might wanna extend this.\n  var abc = 'abcdefghijklmnopqrstuvwxyz';\n  var avgLetterWidthByFontSize = {};\n\n  // Safari doesn't work correctly on font-size smaller than 1 px;\n  var safariGuess = {\n    1: 0.4951923076923077,\n    0.875: 0.43509615384615385,\n    0.833: 0.41346153846153844,\n    0.75: 0.3701923076923077,\n    0.5: 0.24459134615384615,\n  };\n\n  return measure;\n\n  function measure(text, fontSize) {\n    if (fontSize < 1) {\n      // take only first three digits:\n      fontSize = (Math.round(fontSize * 1000)) / 1000;\n    }\n\n    var cacheKey = text + fontSize;\n    var cachedResult = cachedSizes[cacheKey];\n    if (cachedResult) return cachedResult;\n    var result = {};\n\n    cachedSizes[cacheKey] = result;\n\n    var textContainer = window.document.createElementNS(svgns, 'text');\n    // set the font size that is requested.\n    textContainer.setAttributeNS(null, 'font-size', fontSize);\n    // we need this to measure words separators.\n    textContainer.setAttributeNS(xmlns, 'xml:space', 'preserve');\n\n    svgContainer.appendChild(textContainer);\n\n    result.words = text.split(/\\s/).map(toWordWidths);\n    result.spaceWidth = measureSpaceWidth();\n    result.totalWidth = sumUpWordsLengthInPixels(result.words, result.spaceWidth);\n\n    svgContainer.removeChild(textContainer);\n\n    return result;\n\n    function sumUpWordsLengthInPixels(words, spaceWidth) {\n      var width = 0;\n\n      words.forEach(function(word) { width += word.width; });\n      width += (words.length - 1) * spaceWidth;\n\n      return width;\n    }\n\n    function measureSpaceWidth() {\n      var spaceWidthKey = 'space' + fontSize;\n      var spaceWidth = avgLetterWidthByFontSize[spaceWidthKey];\n      if (!spaceWidth) {\n        textContainer.textContent = ' ';\n        spaceWidth = measureTextWidth(textContainer);\n        avgLetterWidthByFontSize[spaceWidthKey] = spaceWidth;\n      }\n\n      return spaceWidth;\n    }\n\n    function toWordWidths(text) {\n      return {\n        text: text,\n        width: measureText(text)\n      };\n    }\n\n    function measureText(text) {\n      return options.useFastTextMeasure ? measureAvgWidth(text) : preciseMeasure(text);\n    }\n\n    function preciseMeasure(text) {\n      var cachedWordsKey = text + fontSize;\n      var size = cachedWords[cachedWordsKey];\n      if (size === undefined) {\n        textContainer.textContent = text;\n        size = measureTextWidth(textContainer);\n        if (size === 0 && text.length > 0) {\n          // safari :(.\n          var avgWidthAtFontSize = safariGuess[fontSize];\n          if (avgWidthAtFontSize === undefined) throw new Error('Font size is not overriden for safari ' + fontSize);\n          size = avgWidthAtFontSize * text.length;\n        }\n        cachedWords[cachedWordsKey] = size;\n      }\n\n      return size;\n    }\n\n    function measureAvgWidth(text) {\n      var avgWidthAtFontSize = avgLetterWidthByFontSize[fontSize];\n      if (!avgWidthAtFontSize) {\n        textContainer.textContent = abc;\n        var abcWidth = measureTextWidth(textContainer);\n        avgWidthAtFontSize = abcWidth/abc.length;\n\n        if (avgWidthAtFontSize === 0) {\n          // safari at small fonts :(. Not super proud of this, but not sure how\n          // to fix this better.\n          avgWidthAtFontSize = safariGuess[fontSize]\n        }\n\n        avgLetterWidthByFontSize[fontSize] = avgWidthAtFontSize;\n      }\n\n      return avgWidthAtFontSize * text.length;\n    }\n  }\n}\n\nfunction measureTextWidth(svgTextElement) {\n  var result = svgTextElement.getBBox();\n  return result.width;\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/measureText.js","export class Vector {\n  constructor(x, y) {\n    this.x = x;\n    this.y = y;\n  }\n  static sub(a, b) {\n    return new Vector(a.x - b.x, a.y - b.y);\n  }\n  static dist(a, b) {\n    let dx = a.x - b.x;\n    let dy = a.y - b.y;\n    return Math.sqrt(dx * dx + dy * dy);\n  }\n  normalize() {\n    let l = Math.sqrt(this.x * this.x + this.y * this.y);\n    if (l === 0)\n      l = 0.0001;\n    this.x /= l;\n    this.y /= l;\n  }\n  mag() {\n    return Math.sqrt(this.x * this.x + this.y * this.y);\n  }\n  add(other) {\n    this.x += other.x;\n    this.y += other.y;\n  }\n  sub(other) {\n    this.x -= other.x;\n    this.y -= other.y;\n  }\n  div(scalar) {\n    this.x /= scalar;\n    this.y /= scalar;\n  }\n  mult(scalar) {\n    this.x *= scalar;\n    this.y *= scalar;\n  }\n  limit(maxMag) {\n    let mag = this.mag();\n    if (mag > maxMag) {\n      this.x *= maxMag / mag;\n      this.y *= maxMag / mag;\n    }\n  }\n  distanceTo(other) {\n    let dx = this.x - other.x;\n    let dy = this.y - other.y;\n    return Math.sqrt(dx * dx + dy * dy);\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/layout/Vector.js","import { Vector } from './Vector';\n\n// https://processing.org/examples/flocking.html\n\nvar random = require('ngraph.random')(45);\n\nexport class Flock {\n  constructor(graph) {\n    this.graph = graph;\n    this.boids = new Map();\n    this.neighbors = [];\n  }\n\n  run() {\n    // this.neighbors.forEach(b => b.run(this.neighbors));\n    let boids = this.boids;\n    boids.forEach((boid, nodeId) => {\n      let neighbors = [];\n      this.graph.forEachLinkedNode(nodeId, function(other) {\n        let otherBoid = boids.get(other.id);\n        if (otherBoid) neighbors.push(otherBoid);\n      })\n      boid.run(neighbors);\n    });\n  }\n\n  addBoid(nodeId, b) {\n    this.boids.set(nodeId, b);\n    this.neighbors.push(b);\n  }\n\n  setDesiredBoidPosition(boidId, pos) {\n    const boid = this.boids.get(boidId);\n    if (!boid) return;\n    boid.setDesiredPosition(pos.x, pos.y);\n  }\n}\n\nexport class Boid {\n  constructor(x, y) {\n    this.acceleration = new Vector(0, 0);\n\n    let angle = random.nextDouble() * 2 * Math.PI;\n    this.velocity = new Vector(Math.cos(angle), Math.sin(angle));\n    this.position = new Vector(x, y);\n    this.desiredPosition = new Vector(0, 0);\n    this.r = 400.0;\n    this.maxspeed = 3;\n    this.maxforce = 0.08;\n  }\n\n  run(boids) {\n    this.flock(boids);\n    this.update();\n  }\n\n  applyForce(force, nCount) {\n    // We could add mass here if we want A = F / M\n    force.div(nCount)\n    this.acceleration.add(force);\n  }\n\n  setDesiredPosition(x, y) {\n    this.desiredPosition.x = x;\n    this.desiredPosition.y = y;\n  }\n\n  // We accumulate a new acceleration each time based on three rules\n  flock(boids) {\n    let sep = this.separate(boids);   // Separation\n    let ali = this.align(boids);      // Alignment\n    let coh = this.cohesion(boids);   // Cohesion\n    // Arbitrarily weight these forces\n    // sep.mult(1.5);\n    // ali.mult(1.0);\n    // coh.mult(1.0);\n    // Add the force vectors to acceleration\n    const mass = boids.length || 1;\n    this.applyForce(sep, mass);\n    this.applyForce(ali, mass);\n    this.applyForce(coh, mass);\n\n    const pull = Vector.sub(this.desiredPosition, this.position);\n    pull.limit(0.091);\n    this.applyForce(pull, mass);\n  }\n\n  // Method to update position\n  update() {\n    // Update velocity\n    this.velocity.add(this.acceleration);\n    // Limit speed\n    this.velocity.limit(this.maxspeed);\n    this.position.add(this.velocity);\n    // Reset acceleration to 0 each cycle\n    this.acceleration.mult(0);\n  }\n\n  // A method that calculates and applies a steering force towards a target\n  // STEER = DESIRED MINUS VELOCITY\n  seek(target) {\n    const desired = Vector.sub(target, this.position);  // A vector pointing from the position to the target\n    // Scale to maximum speed\n    desired.normalize();\n    desired.mult(this.maxspeed);\n \n    // Steering = Desired minus Velocity\n    let steer = Vector.sub(desired, this.velocity);\n    steer.limit(this.maxforce * 1);  // Limit to maximum steering force\n    return steer;\n  }\n\n  // Separation\n  // Method checks for nearby boids and steers away\n  separate(boids) {\n    const desiredseparation = 40.0;\n    const steer = new Vector(0, 0, 0);\n    let count = 0;\n    // For every boid in the system, check if it's too close\n    boids.forEach((other) => {\n      let d = this.position.distanceTo(other.position);\n      // If the distance is greater than 0 and less than an arbitrary amount (0 when you are yourself)\n      if ((d > 0) && (d < desiredseparation)) {\n        // Calculate vector pointing away from neighbor\n        let diff = Vector.sub(this.position, other.position);\n        diff.normalize();\n        diff.div(d);        // Weight by distance\n        steer.add(diff);\n        count++;            // Keep track of how many\n      }\n    });\n\n    // Average -- divide by how many\n    if (count > 0) {\n      steer.div(count);\n    }\n\n    // As long as the vector is greater than 0\n    if (steer.mag() > 0) {\n      // Implement Reynolds: Steering = Desired - Velocity\n      steer.normalize();\n      steer.mult(this.maxspeed);\n      steer.sub(this.velocity);\n      steer.limit(this.maxforce);\n    }\n\n    return steer;\n  }\n\n  // Alignment\n  // For every nearby boid in the system, calculate the average velocity\n  align(boids) {\n    const neighbordist = 300;\n    const sum = new Vector(0, 0);\n    let count = 0;\n    boids.forEach(other => {\n      let d = Vector.dist(this.position, other.position);\n      if ((d > 0) && (d < neighbordist)) {\n        sum.add(other.velocity);\n        count++;\n      }\n    });\n\n    if (count > 0) {\n      sum.div(count);\n      // Implement Reynolds: Steering = Desired - Velocity\n      sum.normalize();\n      sum.mult(this.maxspeed);\n      let steer = Vector.sub(sum, this.velocity);\n      steer.limit(this.maxforce);\n      return steer;\n    } \n    else {\n      return new Vector(0, 0);\n    }\n  }\n\n  // Cohesion\n  // For the average position (i.e. center) of all nearby boids, calculate steering vector towards that position\n  cohesion(boids) {\n    const neighbordist = 300;\n    let sum = new Vector(0, 0);   // Start with empty vector to accumulate all positions\n    let count = 0;\n    boids.forEach(other => {\n      let d = Vector.dist(this.position, other.position);\n      if ((d > 0) && (d < neighbordist)) {\n        sum.add(other.position); // Add position\n        count++;\n      }\n    })\n\n    if (count > 0) {\n      sum.div(count);\n      return this.seek(sum);  // Steer towards the position\n    } \n    else {\n      return new Vector(0, 0);\n    }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/layout/flock.js","import {Flock, Boid} from './flock';\nlet createRandom = require('ngraph.random');\n\nexport default function createFakeLayout(graph) {\n  let nodes = new Map();\n  let random = createRandom(42);\n  const flock = new Flock(graph);\n  \n  return {\n    addNode,\n    getNodePosition,\n    setDesiredNodePosition,\n    step\n  };\n\n  function addNode(nodeId) {\n    const pos = {\n      x: (random.nextDouble() - 0.5) * 1000,\n      y: (random.nextDouble() - 0.5) * 1000\n    }\n    const boid = new Boid(pos.x, pos.y);\n    flock.addBoid(nodeId, boid);\n    nodes.set(nodeId, boid);\n    return boid;\n  }\n\n  function getNodePosition(nodeId) {\n    let pos = nodes.get(nodeId)\n    if (!pos) {\n      pos = addNode(nodeId);\n    } \n    return pos.position;\n  }\n\n  function step() {\n    flock.run();\n  }\n\n  function setDesiredNodePosition(nodeId, pos) {\n    flock.setDesiredBoidPosition(nodeId, pos);\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/layout/boidLayout.js","import Delaunator from 'delaunator';\nimport createGraph from 'ngraph.graph';\n\nexport default function getDelaunayGraph(vertices) {\n  const delaunay = Delaunator.from(vertices);\n  const triangles = delaunay.triangles;\n  const triangulationGraph = createGraph()\n  vertices.forEach(v => {\n    triangulationGraph.addNode(v.id, v);\n  });\n\n  for (let i = triangles.length; i;) {\n    --i\n    const first = vertices[triangles[i]]\n    --i\n    const second = vertices[triangles[i]]\n    --i\n    const third = vertices[triangles[i]]\n\n    addTriangulationLink(first.id, second.id, triangulationGraph)\n    addTriangulationLink(second.id, third.id, triangulationGraph)\n    addTriangulationLink(third.id, first.id, triangulationGraph)\n  }\n\n  return triangulationGraph;\n}\n\nfunction addTriangulationLink (fromId, toId, tGraph) {\n  tGraph.addLink(fromId, toId)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/layout/getDelaunayGraph.js","const createGraph = require('ngraph.graph')\n\nexport default function makeSpanningTree(mstEdges) {\n  const graph = createGraph();\n\n  mstEdges.forEach(e => {\n    graph.addLink(e.from.id, e.to.id)\n  })\n\n  // Doesn't really matter what is the root\n  const rootId = mstEdges[0].from.id\n\n  return {\n    getGraph() {\n      return graph\n    },\n    getRootId() {\n      return rootId\n    },\n    get(id) {\n      return graph.gentNode(id)\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/layout/makeSpanningTree.js","import findMinimumSpanningTree from 'ngraph.kruskal';\nimport getDelaunayGraph from './getDelaunayGraph';\nimport makeSpanningTree from './makeSpanningTree';\n\nclass EdgeModel {\n  constructor (from, to) {\n    this.from = from\n    this.to = to\n  }\n}\n\n/**\n * For a given set of rectangles, removes overlaps\n *\n * @param {Map} rectangles - rectId -> Rectangle mapping\n */\nexport default function removeOverlaps(rectangles, options) {\n  // Convert rectangle centers into vertices, that we can feed into Delaunay\n  // triangulation\n  const vertices = []\n  options = options || {}\n\n  const canMove = options.canMove || yes\n  const pullX = options.pullX || false\n  const pullY = options.pullY || false\n\n  if (rectangles.size < 2) {\n    return;\n  }\n  if (rectangles.size === 2) {\n    // we cannot triangulate this, so let's just cal it directly\n    let arrayOfRects = Array.from(rectangles).map(x => x[1]);\n\n    removeOverlapsForRectangles(arrayOfRects[0], arrayOfRects[1]);\n    return;\n  }\n\n  rectangles.forEach(r => {\n    const pair = [r.cx, r.cy]\n    pair.id = r.id\n    vertices.push(pair)\n  })\n\n  const triangulationGraph = getDelaunayGraph(vertices)\n  triangulationGraph.forEachLink(addTriangulationLinkWeight);\n\n  const mst = findMinimumSpanningTree(triangulationGraph, e => e.data)\n  const mstEdges = mst.map(edge => new EdgeModel(\n    getRect(edge.fromId),\n    getRect(edge.toId)\n  ))\n\n  let spanningTree\n  if (mstEdges.length > 0) {\n    spanningTree = makeSpanningTree(mstEdges)\n\n    grow(spanningTree)\n  }\n\n  return\n\n  function getRect (id) {\n    return rectangles.get(id)\n  }\n\n  function grow(spanningTree) {\n    const spanningGraph = spanningTree.getGraph()\n\n    const processed = new Set()\n    growAt(spanningTree.getRootId())\n\n    function growAt(nodeId) {\n      if (processed.has(nodeId)) return\n\n      processed.add(nodeId)\n\n      const rootPos = getRect(nodeId)\n\n      spanningGraph.forEachLinkedNode(nodeId, otherNode => {\n        if (processed.has(otherNode.id)) return\n\n        const childPos = getRect(otherNode.id)\n        removeOverlapsForRectangles(rootPos, childPos);\n        growAt(otherNode.id)\n      })\n    }\n  }\n\n  function removeOverlapsForRectangles(rootPos, childPos) {\n    if (overlaps(rootPos, childPos)) {\n      let t = getOverlapFactor(rootPos, childPos)\n      let dx = (childPos.cx - rootPos.cx)\n      let dy = (childPos.cy - rootPos.cy)\n\n      if (!Number.isFinite(t)) {\n        t = 1\n        dx = 1e-3\n        dy = -1e-3\n      }\n\n      if (canMove(childPos.id)) {\n        childPos.cx = rootPos.cx + t * dx\n        childPos.cy = rootPos.cy + t * dy\n      } else {\n        rootPos.cx = childPos.cx - t * dx\n        rootPos.cy = childPos.cy - t * dy\n      }\n    }\n  }\n\n  /**\n  * Given two rectangles returns a value by which they overlap\n  */\n  function getOverlapFactor (a, b) {\n    const dx = Math.abs(a.cx - b.cx)\n    const dy = Math.abs(a.cy - b.cy)\n\n    const wx = (a.width + b.width) / 2\n    const wy = (a.height + b.height) / 2\n\n    const t = Math.min(wx / dx, wy / dy)\n    return t\n  }\n\n  function addTriangulationLinkWeight(link) {\n    const from = getRect(link.fromId)\n    const to = getRect(link.toId)\n    const weight = getTriangulationWeight(from, to)\n    link.data = weight;\n  }\n\n  function getTriangulationWeight(a, b) {\n    if (overlaps(a, b)) {\n      const centerDistance = getPointDistance(a, b)\n      const t = getOverlapFactor(a, b)\n      return -(t - 1) * centerDistance\n    }\n\n    return getRectangularDistance(a, b)\n  }\n\n  function overlaps(a, b) {\n    if (pullX) {\n      return true;\n    }\n    // If one rectangle is on left side of other\n    // NOTE: This gives funny results when we always return true\n    if (a.left > b.right || b.left > a.right) return pullX\n\n    // If one rectangle is above other\n    if (a.top > b.bottom || b.top > a.bottom) return pullY\n\n    return true\n  }\n\n  function getRectangularDistance(a, b) {\n    if (overlaps(a, b)) return 0\n    let dx = 0\n    let dy = 0\n\n    if (a.right < b.left) {\n      dx = b.right - a.left\n    } else if (b.right < a.left) {\n      dx = a.left - b.right\n    }\n\n    if (a.top < b.bottom) {\n      dy = b.bottom - a.top\n    } else if (b.top < a.bottom) {\n      dy = a.bottom - b.top\n    }\n\n    return Math.sqrt(dx * dx + dy * dy)\n  }\n\n  function getPointDistance(a, b) {\n    const dx = a.cx - b.cx\n    const dy = a.cy - b.cy\n\n    return Math.sqrt(dx * dx + dy * dy)\n  }\n}\n\nfunction yes() {\n  return true\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/layout/removeOverlaps.js","export default class Rect {\n  constructor (params) {\n    Object.assign(this, params)\n    if (!isNumber(this.left)) throw new Error('Left is wrong')\n    if (!isNumber(this.top)) throw new Error('top is wrong')\n    if (!isNumber(this.width)) throw new Error('width is wrong')\n    if (!isNumber(this.height)) throw new Error('height is wrong')\n  }\n\n  inflate(factor) {\n    this.left += factor * this.width/2;\n    this.top += factor * this.height/2;\n    this.width *= factor;\n    this.height *= factor;\n  }\n\n  get right () {\n    return this.left + this.width\n  }\n\n  get bottom () {\n    return this.top + this.height\n  }\n\n  get cx () {\n    return this.left + this.width / 2\n  }\n\n  get cy () {\n    return this.top + this.height / 2\n  }\n\n  set cx (x) {\n    this.left = x - this.width / 2\n  }\n\n  set cy (y) {\n    this.top = y - this.height / 2\n  }\n}\n\nfunction isNumber (x) {\n  if (!Number.isFinite(x)) return false\n  return true\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/layout/Rect.js","/**\n * This is the core of the layout. The layout here is kind of \"cheating\"\n * layout. The real layout happens in the background and is never shown on\n * the screen until either certain amount of iterations has finished\n * or time quota allowed for the layout exceeded.\n * \n * While background layout does the work, on the front end nodes are \n * flying according to \"Boids\" algorithm (flocking behavior).\n * \n * When background algorithm is finished, the boids are flying to the\n * final positions with simple interpolation animation.\n */\nimport createFakeLayout from './layout/boidLayout';\nimport createInterpolateLayout from './createInterpolateLayout';\nimport removeOverlaps from './layout/removeOverlaps';\nimport Rect from './layout/Rect';\n\nlet eventify = require('ngraph.events');\n\nlet createLayout = require('ngraph.forcelayout')\n\nconst USE_FAKE = 1;\nconst USE_INTERPOLATE = 2;\nconst REMOVE_OVERLAPS = 3;\nconst USE_REAL = 4;\n\n/**\n * Orchestrates layout of algorithm between phases.\n */\nexport default function createAggregateLayout(graph, progress) {\n  const MAX_DEPTH = graph.maxDepth;\n  let physicsLayout = createPhysicsLayout(graph);\n  let fakeLayout = createFakeLayout(graph);\n  let interpolateLayout = createInterpolateLayout(fakeLayout, physicsLayout);\n\n  let isGraphReady = false;\n  let layoutIterations = 0;\n  let layoutTime = 0;\n  let maxLayoutIterations = 2000;\n  let maxLayoutTime = 2000;\n  let phase = USE_FAKE;\n  let rectangles = new Map();\n\n  var api = eventify({\n    step,\n    pinNode,\n    getNodePosition,\n    addNode,\n    setGraphReady,\n    getGraphReady\n  })\n\n  return api;\n\n  function setGraphReady() {\n    layoutIterations = 0;\n    layoutTime = 0;\n    isGraphReady = true;\n  }\n\n  function getGraphReady() {\n    return isGraphReady;\n  }\n\n  function addNode(nodeId, rect) {\n    fakeLayout.addNode(nodeId, rect);\n    rectangles.set(nodeId, rect);\n  }\n\n  function getNodePosition(nodeId) {\n    if (phase === USE_FAKE || phase === REMOVE_OVERLAPS) return fakeLayout.getNodePosition(nodeId);\n    if (phase === USE_REAL) return physicsLayout.getNodePosition(nodeId);\n    if (phase === USE_INTERPOLATE) return interpolateLayout.getNodePosition(nodeId);\n  }\n\n  function step() {\n    if (!isGraphReady || layoutIterations < maxLayoutIterations) {\n      phase = USE_FAKE;\n      let start = window.performance.now();\n      fakeLayout.step();\n\n      do {\n        physicsLayout.step();\n        layoutIterations += 1;\n      } while (window.performance.now() - start < 10)\n      layoutTime += window.performance.now() - start;\n      \n\n      if (layoutTime > maxLayoutTime) layoutIterations = maxLayoutIterations;\n      const finished = Math.min(1, Math.max(layoutTime/maxLayoutTime, layoutIterations/maxLayoutIterations));\n      syncLayouts();\n\n      progress.setLayoutCompletion(Math.round(finished * 100));\n\n      if (layoutIterations >= maxLayoutIterations) phase = REMOVE_OVERLAPS;\n\n      return true;\n    } else if (phase === REMOVE_OVERLAPS) {\n      runOverlapsRemoval();\n      phase = USE_INTERPOLATE;\n\n      return true;\n    } else if (phase === USE_INTERPOLATE) {\n      interpolateLayout.step();\n      if (interpolateLayout.done()) {\n        phase = USE_REAL;\n        api.fire('ready', api);\n      }\n      return true;\n    } \n\n    return false;\n  }\n\n  function syncLayouts() {\n    graph.forEachNode(function (node) {\n      var pos = physicsLayout.getNodePosition(node.id);\n      fakeLayout.setDesiredNodePosition(node.id, pos);\n    })\n  }\n\n  function runOverlapsRemoval() {\n    // TODO: Async?\n    let rectangles = getRectangles();\n    removeOverlaps(rectangles);\n    removeOverlaps(rectangles);\n    removeOverlaps(rectangles);\n    rectangles.forEach((rect, nodeId) => {\n      physicsLayout.setNodePosition(nodeId, rect.left - rect.dx, rect.top - rect.dy);\n    });\n  }\n\n  function getRectangles() {\n    let rects = new Map();\n    rectangles.forEach((rect, id) => {\n      let pos = physicsLayout.getNodePosition(id);\n      let {width, height} = rect;\n      const inflatedRect = new Rect({\n        id, \n        left: pos.x + rect.x,\n        top: pos.y + rect.y,\n        dx: rect.x,\n        dy: rect.y,\n        width,\n        height,\n      });\n      rects.set(id, inflatedRect);\n    });\n\n    return rects;\n  }\n\n  function pinNode(node) {\n    physicsLayout.pinNode(node, true);\n  }\n\n  function createPhysicsLayout() {\n    return createLayout(graph, {\n      springLength: 20,\n      springCoeff: 0.002,\n      gravity: -1.2,\n      theta: 0.8,\n      dragCoeff: 0.02,\n      timeStep: 14,\n      nodeMass(nodeId) {\n        let links = graph.getLinks(nodeId);\n        let mul = links ? links.length : 1;\n        let node = graph.getNode(nodeId);\n        mul *=  (MAX_DEPTH - node.data.depth) + 1;\n        return nodeId.length * mul;\n      }\n    });\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/aggregateLayout.js","export default function createInterpolateLayout(from, to, duration = 100) {\n  let t = 0;\n  let elapsed = 0;\n\n  return {\n    step,\n    getNodePosition,\n    done,\n  };\n\n  function step() {\n    elapsed += 1;\n  }\n\n  function done() {\n    return elapsed > duration;\n  }\n\n  function getNodePosition(nodeId) {\n    t = ease(elapsed/duration);\n    let fromPos = from.getNodePosition(nodeId);\n    let toPos = to.getNodePosition(nodeId);\n\n    return {\n      x: fromPos.x * (1 - t) + toPos.x * t,\n      y: fromPos.y * (1 - t) + toPos.y * t\n    }\n  }\n\n  function ease(t) {\n    return t*(2-t);\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/createInterpolateLayout.js","/**\n * This file is responsible for animating edges when nodes positions are known.\n */\nlet svg = require('simplesvg');\nlet random = require('ngraph.random')(42);\n\nexport default function createLinkAnimator(graph, layout, edgeContainer) {\n  const links = new Map();\n  let beingAnimated = new Map();\n  const scheduled = [];\n  let maxAnimations = 20;\n  let maxDepth = graph.maxDepth;\n  graph.forEachLink(scheduleLink);\n  scheduled.sort((a, b) => {\n    return getLinkScore(a) - getLinkScore(b)\n  })\n  let processor = requestAnimationFrame(processNext);\n\n  return {\n    getLinkInfo,\n    dispose\n  }\n\n  function dispose() {\n    if (processor) {\n      cancelAnimationFrame(processor);\n      processor = null;\n    }\n  }\n\n  function processNext() {\n    while (beingAnimated.size < maxAnimations && scheduled.length > 0) {\n      let link = scheduled.pop()\n      let speed = Math.round(Math.abs(random.gaussian() * 30)) + 1\n      beingAnimated.set(link.id, animateLink(link, speed));\n    }\n\n    beingAnimated.forEach(function(el, key) {\n      el.step();\n      if (el.isDone) beingAnimated.delete(key);\n    });\n    if (scheduled.length > 0 || beingAnimated.size > 0) {\n      processor = requestAnimationFrame(processNext);\n    }\n  }\n\n  function getLinkInfo(linkId) {\n    return links.get(linkId);\n  }\n\n  function getLinkScore(link) {\n    let fromNode = graph.getNode(link.fromId).data;\n    let toNode = graph.getNode(link.toId).data;\n    const depth = (fromNode.depth + toNode.depth)/2;\n    return (maxDepth - depth)/maxDepth;\n  }\n\n  function scheduleLink(link) {\n    scheduled.push(link);\n  }\n\n  function animateLink(link, maxT) {\n    var frame = 0;\n    let from = layout.getNodePosition(link.fromId);\n    let to = layout.getNodePosition(link.toId);\n\n    const dRatio = getLinkScore(link)\n    const strokeWidth = 8 * dRatio + 2;\n    const color = Math.round((200 - 75) * (1 - dRatio) + 75);\n\n    let api = {\n      step,\n      isDone: false\n    }\n    return api;\n\n    function step() {\n      let t = ease(frame/maxT);\n      let x = from.x * (1 - t) + to.x * t;\n      let y = from.y * (1 - t) + to.y * t;\n      let linkInfo = links.get(link.id);\n      let pathData = `M${from.x},${from.y} L${x},${y}`;\n      if (!linkInfo) {\n        const ui = svg('path', {\n          class: 'link-ui',\n          id: link.id,\n          'stroke-width': strokeWidth,\n          fill: 'black',\n          stroke: `rgb(${color}, ${color}, ${color})`,\n          d: pathData \n        });\n        edgeContainer.appendChild(ui);\n\n        links.set(link.id, {ui, link});\n      } else {\n        linkInfo.ui.attr('d', pathData);\n      }\n      frame += 1;\n      if (frame > maxT) {\n        api.isDone = true;\n      }\n    }\n  }\n}\n\nfunction ease(t) {\n  return t*(2-t);\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/renderer/linkAnimator.js","import Flatbush from 'flatbush';\n\n/**\n * This function constructs a spatial index for every edge of a graph,\n * so that users don't have to be extremely precise with mouse movement\n * when hovering over an edge.\n */\nexport default function buildLinkIndex(graph, layout, maxDistance = 42) {\n  // The `pointIndex` is spatial lookup into collection of `points`.\n  // Each point has a `link` and `x, y` coordinates.\n  let {pointIndex, points} = createInternalIndex();\n  \n  return {\n    /**\n     * Finds an edge near `x, y` coordinates\n     */\n    findNearestLink,\n\n    /**\n     * Just a debugger method to render indexed points\n     */\n    getPoints() { return points; }\n  };\n\n  function findNearestLink(x, y) {\n    const neighborIds = pointIndex.neighbors(x, y, 1);\n    let pointId = neighborIds[0];\n    if (pointId === undefined) return;\n    let point = points[pointId];\n    if (distance({x,y}, point) < maxDistance) return point.link;\n  }\n\n  function createInternalIndex() {\n    // The main idea is very simple - slice every single link with a ball of radius\n    // `maxDistance`, and then build a spatial index tree.\n    let step = maxDistance\n    let points = [];\n\n    graph.forEachLink(link => {\n      let from = layout.getNodePosition(link.fromId);\n      let to = layout.getNodePosition(link.toId)\n      let linkDistance = distance(from, to);\n\n      // This is going to be the direction in which we will be adding circles:\n      let dx = to.x - from.x; let dy = to.y - from.y;\n      dx /= linkDistance; dy /= linkDistance;\n\n      // Start from the link point\n      let nextPoint = {\n        x: from.x,\n        y: from.y,\n        link\n      };\n\n      // And slice the link into pieces...\n      while (distance(nextPoint, from) < linkDistance) {\n        points.push(nextPoint);\n        nextPoint = {\n          x: nextPoint.x + step * dx,\n          y: nextPoint.y + step * dy,\n          link\n        };\n      }\n\n      // Don't forget about last point of the link:\n      points.push({\n        x: to.x,\n        y: to.y,\n        link\n      });\n    });\n\n    // Now we have all points, we can build spatial index:\n    let pointIndex = new Flatbush(points.length)\n    let pointSize = step * 0.4;\n    points.forEach(point => {\n      pointIndex.add(\n        point.x - pointSize, point.y - pointSize, \n        point.x + pointSize, point.y + pointSize\n      );\n    });\n    pointIndex.finish();\n    return {pointIndex, points};\n  }\n}\n\nfunction distance(a, b) {\n  let dx = b.x - a.x;\n  let dy = b.y - a.y;\n  return Math.sqrt(dx * dx + dy * dy);\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/buildLinkIndex.js","/**\n * The core of the rendering process\n */\nimport createPanZoom from 'panzoom';\nimport createTextMeasure from './measureText';\nimport createAggregateLayout from './aggregateLayout';\nimport bus from '../bus';\nimport createLinkAnimator from './renderer/linkAnimator';\nimport buildLinkIndex from './buildLinkIndex';\n\nlet svg = require('simplesvg');\n\n/**\n * Creates a new renderer. The rendering is done with SVG.\n */\nexport default function createRenderer(progress) {\n  const scene = document.querySelector('#scene');\n  const nodeContainer = scene.querySelector('#nodes');\n  const edgeContainer = scene.querySelector('#edges');\n  const hideTooltipArgs = {isVisible: false};\n  const svgEl = document.querySelector('svg');\n  const pt = svgEl.createSVGPoint();\n  const panzoom = createPanZoom(scene);\n  const defaultRectangle = {left: -500, right: 500, top: -500, bottom: 500}\n  panzoom.showRectangle(defaultRectangle);\n\n  // maps node id to node ui\n  let nodes = new Map();\n\n  let linkIndex;\n  let layout, graph, currentLayoutFrame = 0, linkAnimator;\n  let textMeasure = createTextMeasure(scene);\n  bus.on('graph-ready', onGraphReady);\n\n  return {\n    render,\n    dispose\n  }\n\n  function dispose() {\n    clearLastScene();\n    bus.off('graph-ready', onGraphReady);\n  }\n\n  function onMouseMove(e) {\n    let link = findLinkInfoFromEvent(e);\n    if (link) {\n      showTooltip(link, e.clientX, e.clientY);\n    } else {\n      hideTooltip();\n    }\n  }\n\n  function getNearestLink(x, y) {\n    if (!linkIndex) return;\n\n    pt.x = x; pt.y = y;\n    let svgP = pt.matrixTransform(scene.getScreenCTM().inverse());\n    let link = linkIndex.findNearestLink(svgP.x, svgP.y, 30);\n    if (link) return link.id;\n  }\n\n  function onSceneClick(e) {\n    let info = findLinkInfoFromEvent(e);\n    if (info)  {\n      bus.fire('show-details', info.link);\n    }\n  }\n\n  function findLinkInfoFromEvent(e) {\n    const id = e.target && e.target.id;\n    let linkInfo = linkAnimator.getLinkInfo(id);\n    if (!linkInfo) {\n      let linkId = getNearestLink(e.clientX, e.clientY);\n      linkInfo = linkAnimator.getLinkInfo(linkId);\n    }\n    return linkInfo;\n  }\n\n  function showTooltip(minLink, clientX, clientY) {\n    const {fromId, toId} = minLink.link;\n    bus.fire('show-tooltip', {\n      isVisible: true,\n      from: fromId, \n      to: toId, \n      x: clientX,\n      y: clientY\n    });\n\n    removeHighlight();\n\n    nodes.get(fromId).classList.add('hovered');\n    nodes.get(toId).classList.add('hovered');\n    minLink.ui.classList.add('hovered');\n  }\n\n  function hideTooltip() {\n    bus.fire('show-tooltip', hideTooltipArgs);\n    removeHighlight();\n  }\n\n  function removeHighlight() {\n    scene.querySelectorAll('.hovered').forEach(removeHoverClass);\n  }\n\n  function removeHoverClass(el) {\n    el.classList.remove('hovered');\n  }\n\n  function render(newGraph) {\n    clearLastScene();\n    graph = newGraph;\n\n    layout = createAggregateLayout(graph, progress);\n    \n    layout.on('ready', drawLinks);\n\n    nodes = new Map();\n\n    graph.forEachNode(addNode);\n    graph.on('changed', onGraphStructureChanged);\n\n    cancelAnimationFrame(currentLayoutFrame);\n    currentLayoutFrame = requestAnimationFrame(frame)\n  }\n\n  function onGraphReady(readyGraph) {\n    if (readyGraph === graph) {\n      layout.setGraphReady();\n      progress.startLayout();\n    }\n  }\n\n  function frame() {\n    if (layout.step()) {\n      currentLayoutFrame = requestAnimationFrame(frame)\n    }\n    updatePositions();\n  }\n\n  function onGraphStructureChanged(changes) {\n    changes.forEach(change => {\n      if (change.changeType === 'add' && change.node) {\n        addNode(change.node);\n      }\n    })\n  }\n\n  function drawLinks() {\n    progress.done();\n    linkAnimator = createLinkAnimator(graph, layout, edgeContainer);\n    document.addEventListener('mousemove', onMouseMove);\n    svgEl.addEventListener('click', onSceneClick);\n    let radius = 42;\n    linkIndex = buildLinkIndex(graph, layout, radius);\n    // let points = linkIndex.getPoints();\n    // points.forEach(point => {\n    //   scene.appendChild(svg('circle', {\n    //     cx: point.x,\n    //     cy: point.y,\n    //     r: radius,\n    //     fill: 'transparent',\n    //   }))\n    // })\n  }\n\n  function clearLastScene() {\n    clear(nodeContainer);\n    clear(edgeContainer);\n\n    document.removeEventListener('mousemove', onMouseMove);\n    svgEl.removeEventListener('click', onSceneClick);\n    if (layout) layout.off('ready', drawLinks);\n    if (graph) graph.off('changed', onGraphStructureChanged);\n    if (linkAnimator) linkAnimator.dispose();\n  }\n\n  function clear(el) {\n    while (el.lastChild) {\n        el.removeChild(el.lastChild);\n    }\n  }\n\n  function addNode(node) {\n    const dRatio = (graph.maxDepth - node.data.depth)/graph.maxDepth;\n    let pos = getNodePosition(node.id);\n    if (node.data.depth === 0) {\n      layout.pinNode(node);\n    }\n\n    const uiAttributes = getNodeUIAttributes(node.id, dRatio);\n    layout.addNode(node.id, uiAttributes);\n\n    const rectAttributes = {\n      x: uiAttributes.x,\n      y: uiAttributes.y,\n      width: uiAttributes.width,\n      height: uiAttributes.height,\n      rx: uiAttributes.rx,\n      ry: uiAttributes.ry,\n      fill: 'white',\n      'stroke-width': uiAttributes.strokeWidth, \n      stroke: '#58585A'\n    }\n    const textAttributes = {\n      'font-size': uiAttributes.fontSize,\n      x: uiAttributes.px,\n      y: uiAttributes.py\n    }\n    \n    const rect = svg('rect', rectAttributes);\n    const text = svg('text', textAttributes)\n    text.text(node.id);\n\n    const ui = svg('g', {\n      transform: `translate(${pos.x}, ${pos.y})`\n    });\n    ui.appendChild(rect);\n    ui.appendChild(text);\n\n    nodeContainer.appendChild(ui);\n    nodes.set(node.id, ui);\n  }\n\n\n  function getNodeUIAttributes(nodeId, dRatio) {\n    const fontSize = 24 * dRatio + 12;\n    const size = textMeasure(nodeId, fontSize);\n    const width = size.totalWidth + size.spaceWidth * 6;\n    const height = fontSize * 1.6;\n\n    return {\n      fontSize,\n      width,\n      height,\n      x: -width/2,\n      y: -height/2,\n      rx: 15 * dRatio + 2,\n      ry: 15 * dRatio + 2,\n      px: -width/2 + size.spaceWidth*3,\n      py: -height/2 + fontSize * 1.1,\n      strokeWidth: 4 * dRatio + 1\n    };\n  }\n\n  function updatePositions() {\n    nodes.forEach((ui, nodeId) => {\n      let pos = getNodePosition(nodeId)\n      ui.attr('transform', `translate(${pos.x}, ${pos.y})`);\n    });\n  }\n\n  function getNodePosition(nodeId) {\n    return layout.getNodePosition(nodeId);\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/createRenderer.js","<template>\n  <div class='about'>\n    <div class='background absolute' @click.prevent='close'></div>\n    <div class='content'>\n      <h3>Autocomplete vs Graph <a class='close bold highlight' href='#' @click.prevent='close'>close</a></h3>\n      <p>\n        Have you ever noticed how Google auto-completes your queries? Like so:\n        <img src=\"https://i.imgur.com/Dz0crfG.gif\" alt=\"google auto complete demo\" width='300px'>\n      </p>\n      <p>What if we repeat the same query for every suggestion? We will get a bigger picture:</p>\n      <img src=\"https://i.imgur.com/aqzfpBJ.png\" alt=\"Bigger picture with all searches\" width='300px'>\n      \n      <p>Now let's repeat this process one more time for every found suggestion. But instead of\n        drawing a picture, let's draw a line between each suggestion:</p>\n        <img src=\"https://i.imgur.com/OBbEJP7.png\" alt=\"suggestions graph\" width=\"300px\">\n\n      <p>And this is exactly what this website is doing for You.</p>\n      <p>I found this technique useful to find alternatives, or to perform a market research.\n        Obviously, for this technique to work, Google needs to know enough about your query.\n      </p>\n      <p>I hope you like it! Please let me know.</p>\n      <ul>\n        <li>\n          <a href='https://github.com/anvaka/vs' class='highlight'>Read source code</a> of this project on GitHub\n        </li><li>\n        Stay tuned for updates on <a href='https://twitter.com/anvaka' class='highlight'>Twitter.</a>\n        </li><li>\n        <a href='https://www.patreon.com/anvaka' class='highlight'>Support me on Patreon</a> .\n        </li>\n      </ul>\n      <p>With passion,<br/> Anvaka</p>\n      <a href='#' @click.prevent='close' class='large-close bold highlight'>\n        close\n      </a>\n    </div>\n  </div>\n</template>\n<script>\n\nexport default {\n  mounted() {\n    this.closeHandler = (e) => {\n      if (e.keyCode === 27) {\n        e.preventDefault();\n        this.close();\n      }\n    }\n    document.addEventListener('keyup', this.closeHandler);\n  },\n  beforeDestroy() {\n    document.removeEventListener('keyup', this.closeHandler);\n  },\n  methods: {\n    close() {\n      this.$emit('close');\n    }\n  }\n}\n</script>\n\n<style lang='stylus'>\n.about {\n  position: fixed;\n  overflow: hidden;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n\n  .close {\n    position: absolute;\n    right: 15px;\n    font-size: 12px;\n  }\n\n  .large-close {\n    width: 100%;\n    height: 32px;\n    display: block;\n    text-align: center;\n  }\n\n  .content {\n    overflow-y: auto;\n    max-height: 100%;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.2), 0 -1px 0px rgba(0,0,0,0.02);\n    position: absolute;\n    background-color: white;\n    width: 400px;\n    padding: 14px;\n    border: 1px solid #58585A;\n    h3 {\n      margin: 0;\n      font-weight: normal;\n    }\n  }\n}\n\n\n.background {\n  position: absolute;\n  background-color: #58585A;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n\n@media (max-width: 800px) {\n  .about {\n    justify-content: initial;\n  }\n  .about .content {\n    width: 100%;\n    border: none;\n  }\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/About.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"about\"},[_c('div',{staticClass:\"background absolute\",on:{\"click\":function($event){$event.preventDefault();return _vm.close($event)}}}),_vm._v(\" \"),_c('div',{staticClass:\"content\"},[_c('h3',[_vm._v(\"Autocomplete vs Graph \"),_c('a',{staticClass:\"close bold highlight\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.close($event)}}},[_vm._v(\"close\")])]),_vm._v(\" \"),_vm._m(0),_vm._v(\" \"),_c('p',[_vm._v(\"What if we repeat the same query for every suggestion? We will get a bigger picture:\")]),_vm._v(\" \"),_c('img',{attrs:{\"src\":\"https://i.imgur.com/aqzfpBJ.png\",\"alt\":\"Bigger picture with all searches\",\"width\":\"300px\"}}),_vm._v(\" \"),_c('p',[_vm._v(\"Now let's repeat this process one more time for every found suggestion. But instead of\\n      drawing a picture, let's draw a line between each suggestion:\")]),_vm._v(\" \"),_c('img',{attrs:{\"src\":\"https://i.imgur.com/OBbEJP7.png\",\"alt\":\"suggestions graph\",\"width\":\"300px\"}}),_vm._v(\" \"),_c('p',[_vm._v(\"And this is exactly what this website is doing for You.\")]),_vm._v(\" \"),_c('p',[_vm._v(\"I found this technique useful to find alternatives, or to perform a market research.\\n      Obviously, for this technique to work, Google needs to know enough about your query.\\n    \")]),_vm._v(\" \"),_c('p',[_vm._v(\"I hope you like it! Please let me know.\")]),_vm._v(\" \"),_vm._m(1),_vm._v(\" \"),_vm._m(2),_vm._v(\" \"),_c('a',{staticClass:\"large-close bold highlight\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.close($event)}}},[_vm._v(\"\\n      close\\n    \")])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',[_vm._v(\"\\n      Have you ever noticed how Google auto-completes your queries? Like so:\\n      \"),_c('img',{attrs:{\"src\":\"https://i.imgur.com/Dz0crfG.gif\",\"alt\":\"google auto complete demo\",\"width\":\"300px\"}})])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ul',[_c('li',[_c('a',{staticClass:\"highlight\",attrs:{\"href\":\"https://github.com/anvaka/vs\"}},[_vm._v(\"Read source code\")]),_vm._v(\" of this project on GitHub\\n      \")]),_c('li',[_vm._v(\"\\n      Stay tuned for updates on \"),_c('a',{staticClass:\"highlight\",attrs:{\"href\":\"https://twitter.com/anvaka\"}},[_vm._v(\"Twitter.\")])]),_c('li',[_c('a',{staticClass:\"highlight\",attrs:{\"href\":\"https://www.patreon.com/anvaka\"}},[_vm._v(\"Support me on Patreon\")]),_vm._v(\" .\\n      \")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',[_vm._v(\"With passion,\"),_c('br'),_vm._v(\" Anvaka\")])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-1277c4ae\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/About.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-1277c4ae\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./About.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./About.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./About.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-1277c4ae\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./About.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/About.vue\n// module id = null\n// module chunks = ","<template>\n  <div class='query-input-container' @click.prevent='focus'>\n    <input class='search-input' \n      :value='value' @input=\"$emit('input', $event.target.value)\"\n      type='text' :placeholder='placeholder' autofocus ref='input'>\n    <span type='text' class='prefix' ref='prefix'>{{patternPrefix}}</span> \n    <span class='search-measure' ref='measure'></span>\n    <span type='text' class='suffix' ref='suffix'>{{patternReminder}}</span> \n  </div>\n</template>\n\n<script>\n/**\n * A user control that renders input string with read-only prefix/suffix\n */\nexport default {\n  props: ['placeholder', 'value', 'pattern'],\n  watch: {\n    value(newValue) {\n      this.ensureSuffixPos();\n    }\n  },\n  computed: {\n    patternReminder() {\n      return this.pattern.split('[query]')[1];\n    },\n    patternPrefix() {\n      return this.pattern.split('[query]')[0];\n    }\n  },\n  methods: {\n    focus() {\n      this.$refs.input.focus();\n    },\n    ensureSuffixPos() {\n      // We have to measure each bit of text (prefix, content, suffix), so that\n      // we can place labels accordingly.\n      // Good thing that this doesn't happen often. Otherwise this would be super slow\n      const {suffix, measure, prefix} = this.$refs;\n\n      measure.innerText = this.value;\n      let textWidth = this.$refs.measure.getBoundingClientRect();\n\n      measure.innerText = this.patternReminder;\n      let suffixBox = measure.getBoundingClientRect();\n\n      measure.innerText = this.patternPrefix;\n      let prefixBox = measure.getBoundingClientRect();\n\n      let selfBox = this.$el.getBoundingClientRect();\n      let maxValue = selfBox.width - suffixBox.width;\n\n      let suffixPos = Math.min(prefixBox.width + textWidth.width + 4, maxValue);\n      if (this.value.length === 0) {\n        // When there is nothing entered, let's hide prefix/suffix.\n        suffix.style.visibility = 'hidden';\n        prefix.style.visibility = 'hidden';\n        this.$refs.input.style.paddingRight = '0';\n        this.$refs.input.style.paddingLeft = '0';\n      } else {\n        suffix.style.visibility = 'visible';\n        prefix.style.visibility = 'visible';\n        suffix.style.left = suffixPos + 'px';\n        prefix.style.right = prefixBox.width + 'px';\n        this.$refs.input.style.paddingRight = suffixBox.width + 'px';\n        this.$refs.input.style.paddingLeft = prefixBox.width + 'px';\n      }\n    }\n  },\n  mounted() {\n    this.ensureSuffixPos();\n  }\n}\n</script>\n\n<style lang=\"stylus\">\n@import('../vars.styl');\n\n.query-input-container {\n  position: relative;\n  span {\n    display: inline;\n  }\n  .search-measure, .suffix {\n    position: absolute;\n    left: 0;\n  }\n  .suffix {\n    right: 0;\n    top: 0;\n    bottom: 0;\n    position: absolute;\n    display: flex;\n    color: #eaaac0;\n    pointer-events: none;\n  }\n\n  .prefix {\n    pointer-events: none;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    position: absolute;\n    display: flex;\n    color: #eaaac0;\n  }\n\n  input {\n    border: none;\n    font-family: 'Avenir', Helvetica, Arial, sans-serif;\n    padding: 0;\n    color: highlight-color\n    height: 100%;\n    font-size: 16px;\n    &:focus {\n      outline: none;\n    }\n  }\n}\n\n.search-measure {\n  white-space: pre;\n  visibility: hidden;\n}\n\ninput.search-input {\n  width: 100%;\n\n}\n\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/QueryInput.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"query-input-container\",on:{\"click\":function($event){$event.preventDefault();return _vm.focus($event)}}},[_c('input',{ref:\"input\",staticClass:\"search-input\",attrs:{\"type\":\"text\",\"placeholder\":_vm.placeholder,\"autofocus\":\"\"},domProps:{\"value\":_vm.value},on:{\"input\":function($event){return _vm.$emit('input', $event.target.value)}}}),_vm._v(\" \"),_c('span',{ref:\"prefix\",staticClass:\"prefix\",attrs:{\"type\":\"text\"}},[_vm._v(_vm._s(_vm.patternPrefix))]),_vm._v(\" \"),_c('span',{ref:\"measure\",staticClass:\"search-measure\"}),_vm._v(\" \"),_c('span',{ref:\"suffix\",staticClass:\"suffix\",attrs:{\"type\":\"text\"}},[_vm._v(_vm._s(_vm.patternReminder))])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-15cdf59a\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/QueryInput.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-15cdf59a\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./QueryInput.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./QueryInput.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./QueryInput.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-15cdf59a\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./QueryInput.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/QueryInput.vue\n// module id = null\n// module chunks = ","<template>\n  <div id=\"app\">\n    <form v-on:submit.prevent=\"onSubmit\" class='search-box'>\n      <span @click.prevent='forwardFocus'>Graph for</span>\n      <query-input class='query-input' placeholder='Enter query' v-model='appState.query' :pattern='appState.pattern' ref='queryInput'></query-input>\n      <a type='submit' class='search-submit' href='#' @click.prevent='onSubmit' v-if='appState.query'>Go</a>\n    </form>\n    <div class='help' v-if='!isLoading'>\n      The graph was made from Google's auto-complete.\n      <a href='#' @click.prevent='aboutVisible = true' class='highlight'>Learn more.</a>\n    </div>\n    <div class='help' v-if='isLoading'>{{appState.progress.message}}</div>\n    <div class='about-line'>\n      <a class='about-link' href='#' @click.prevent='aboutVisible = true'>about</a>\n      <a class='bold' href='http://github.com/anvaka/vs'>source code</a>\n    </div>\n\n    <about v-if='aboutVisible' @close='aboutVisible = false'></about>\n\n    <div class='welcome' v-if='!appState.hasGraph'>\n      <h3>Welcome!</h3>\n      <p>This website renders graph of Google's auto-complete.\n      <a class='highlight' href='#' @click.prevent='aboutVisible = true'>Click here</a> to learn more, or <a class='highlight' href='?query=iphone'>try demo</a>.\n         </p>\n    </div>\n\n    <div class='tooltip' ref='tooltip'>{{tooltip.text}}</div>\n\n  </div>\n</template>\n\n<script>\nimport appState, {performSearch, resolveQueryFromLink} from './appState.js';\nimport createRenderer from './lib/createRenderer';\nimport About from './components/About';\nimport QueryInput from './components/QueryInput';\nimport bus from './bus'\n\nexport default {\n  name: 'App',\n  data() {\n    return {\n      aboutVisible: false,\n      appState,\n      tooltip: {\n        text: '',\n        x: '',\n        y: ''\n      }\n    };\n  },\n  components: {\n    About,\n    QueryInput\n  },\n  computed: {\n    isLoading() {\n      return appState.progress.working;\n    },\n  },\n  methods: {\n    forwardFocus() {\n      this.$refs.queryInput.focus();\n    },\n    onSubmit() {\n      if (!appState.query) return;\n\n      performSearch(appState.query)\n      this.renderer.render(appState.graph);\n      const el = document.querySelector( ':focus' );\n      if(el) el.blur();\n    },\n\n    showTooltip(event) {\n      const el = this.$refs.tooltip;\n      if (event.isVisible) {\n        el.classList.add('visible');\n        el.innerText = resolveQueryFromLink(event.from, event.to);\n        el.style.left = (event.x + 16) + 'px';\n        el.style.top = (event.y - 16) + 'px';\n      } else {\n        el.classList.remove('visible');\n      }\n    },\n\n    showDetails(link) {\n      const query = resolveQueryFromLink(link.fromId, link.toId);\n      window.open('https://google.com/search?q=' + encodeURIComponent(query), '_blank');\n    }\n  },\n  mounted() {\n    this.renderer = createRenderer(appState.progress);\n    bus.on('show-tooltip', this.showTooltip, this);\n    bus.on('show-details', this.showDetails, this);\n    if (appState.graph) {\n      this.renderer.render(appState.graph);\n    }\n  },\n  beforeDestroy() {\n    bus.off('show-tooltip', this.showTooltip, this);\n    bus.off('show-details', this.showDetails, this);\n  }\n\n}\n</script>\n\n<style lang='stylus'>\n@import('./vars.styl');\n\n#app {\n  position: relative;\n  margin: 8px 14px;\n  width: 392px;\n  background: background-color;\n}\n\n.query-input {\n  flex: 1;\n  margin-left: 8px;\n}\n\n.highlight {\n  color: highlight-color;\n}\n\nrect, path, text {\n  transition: stroke 200ms, fill 200ms;\n}\n\n.hovered rect,\npath.hovered {\n  stroke: highlight-color;\n}\n\n.hovered rect {\n  stroke: highlight-color;\n}\n\n.help {\n  font-size: 12px;\n  margin-top: 8px;\n  a {\n    background: background-color;\n  }\n}\na {\n  &:hover, &:focus {\n    color: highlight-color;\n    border-bottom: 1px dashed;  \n  }\n}\n.search-submit {\n  align-items: center;\n  text-decoration: none;\n  display: flex;\n  flex-shrink: 0;\n  width: 48px;\n  justify-content: center;\n  outline: none;\n  &:hover, &:focus {\n    color: background-color;\n    background: highlight-color;\n  }\n}\n.special {\n  color: highlight-color;\n  font-family: monospace;\n}\na {\n  text-decoration: none;\n}\n\n.about-line {\n  position: fixed;\n  right: 0;\n  top: 8px;\n  padding: 0px 0;\n  display: flex;\n  flex-direction: column;\n  align-items: stretch;\n\n  a {\n    text-align: right;\n    background: background-color;\n    font-size: 12px;\n    padding: 0 8px;\n    line-height: 24px;\n    height: 24px;\n    color: secondary-color;\n    border-bottom: 1px solid transparent;\n    &:hover, &:focus {\n      color: highlight-color;\n      border-bottom: 1px dashed;\n    }\n  }\n}\n\n.tooltip {\n  box-shadow: 0 2px 4px rgba(0,0,0,0.2), 0 -1px 0px rgba(0,0,0,0.02);\n  position: fixed;\n  background: background-color;\n  padding: 8px;\n  border: 1px solid border-color;\n  pointer-events: none;\n  opacity: 0;\n  transition-duration: 300ms;\n  transition-property: opacity;\n}\n.tooltip.visible {\n  opacity: 1;\n}\n\n.search-box {\n  position: relative;\n  box-shadow: 0 2px 4px rgba(0,0,0,0.2), 0 -1px 0px rgba(0,0,0,0.02);\n  height: 48px;\n  display: flex;\n  font-size: 16px;\n  padding: 0 0 0 8px;\n  cursor: text;\n\n  a {\n    color: #B2B2B2\n    cursor: pointer;\n  }\n  span {\n    display: flex;\n    align-items: center;\n    flex-shrink: 0;\n  }\n\n}\n\n\n@media (max-width: 800px) {\n  #app {\n    width: 100%;\n    margin: 0;\n  }\n  .welcome {\n    padding: 16px;\n  }\n  .help {\n    padding: 0 8px;\n  }\n  .about-line {\n    bottom: 0;\n    top: initial;\n    right: 0;\n  }\n}\n\n@media (max-height: 550px) {\n  .search-box {\n    height: 32px;\n    input.search-input {  \n      font-size: 16px;\n    }\n\n  }\n  .help {\n    margin-top: 4px;\n  }\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/App.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('form',{staticClass:\"search-box\",on:{\"submit\":function($event){$event.preventDefault();return _vm.onSubmit($event)}}},[_c('span',{on:{\"click\":function($event){$event.preventDefault();return _vm.forwardFocus($event)}}},[_vm._v(\"Graph for\")]),_vm._v(\" \"),_c('query-input',{ref:\"queryInput\",staticClass:\"query-input\",attrs:{\"placeholder\":\"Enter query\",\"pattern\":_vm.appState.pattern},model:{value:(_vm.appState.query),callback:function ($$v) {_vm.$set(_vm.appState, \"query\", $$v)},expression:\"appState.query\"}}),_vm._v(\" \"),(_vm.appState.query)?_c('a',{staticClass:\"search-submit\",attrs:{\"type\":\"submit\",\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.onSubmit($event)}}},[_vm._v(\"Go\")]):_vm._e()],1),_vm._v(\" \"),(!_vm.isLoading)?_c('div',{staticClass:\"help\"},[_vm._v(\"\\n    The graph was made from Google's auto-complete.\\n    \"),_c('a',{staticClass:\"highlight\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();_vm.aboutVisible = true}}},[_vm._v(\"Learn more.\")])]):_vm._e(),_vm._v(\" \"),(_vm.isLoading)?_c('div',{staticClass:\"help\"},[_vm._v(_vm._s(_vm.appState.progress.message))]):_vm._e(),_vm._v(\" \"),_c('div',{staticClass:\"about-line\"},[_c('a',{staticClass:\"about-link\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();_vm.aboutVisible = true}}},[_vm._v(\"about\")]),_vm._v(\" \"),_c('a',{staticClass:\"bold\",attrs:{\"href\":\"http://github.com/anvaka/vs\"}},[_vm._v(\"source code\")])]),_vm._v(\" \"),(_vm.aboutVisible)?_c('about',{on:{\"close\":function($event){_vm.aboutVisible = false}}}):_vm._e(),_vm._v(\" \"),(!_vm.appState.hasGraph)?_c('div',{staticClass:\"welcome\"},[_c('h3',[_vm._v(\"Welcome!\")]),_vm._v(\" \"),_c('p',[_vm._v(\"This website renders graph of Google's auto-complete.\\n    \"),_c('a',{staticClass:\"highlight\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();_vm.aboutVisible = true}}},[_vm._v(\"Click here\")]),_vm._v(\" to learn more, or \"),_c('a',{staticClass:\"highlight\",attrs:{\"href\":\"?query=iphone\"}},[_vm._v(\"try demo\")]),_vm._v(\".\\n       \")])]):_vm._e(),_vm._v(\" \"),_c('div',{ref:\"tooltip\",staticClass:\"tooltip\"},[_vm._v(_vm._s(_vm.tooltip.text))])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-38a743b7\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-38a743b7\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n}\nvar normalizeComponent = require(\"!../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\nimport __vue_script__ from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\n/* template */\nimport __vue_template__ from \"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-38a743b7\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = null\n// module chunks = ","/**\n * This is the entry point into the application. \n * \n * From here I recommend to go to ./lib/buildGraph.js to see how the graph is created\n * or to the ./lib/createRenderer.js that initializes rending process\n */\nimport Vue from 'vue'\nimport App from './App'\n\nVue.config.productionTip = false\n\n/* eslint-disable no-new */\nnew Vue({\n  el: '#app',\n  components: { App },\n  template: '<App/>'\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js"],"sourceRoot":""}